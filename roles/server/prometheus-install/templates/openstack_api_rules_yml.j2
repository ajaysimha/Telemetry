{{ ansible_managed | comment }}
groups:
 - name: API_status
   interval: 1m
   rules:
{% for service in osp_monitored_services %}
   - alert: Openstack Service ({{ service }}) is down
     expr: avg_over_time({service=~"{{ service }}" ,job="openstack"}[1m])==0
     for: 30s
     labels:
       severity: critical
     annotations:
       summary: openstack service {% raw %}{{$labels.service}} {% endraw %}is down
       description: "openstack  {% raw %}{{$labels.service}}{% endraw %} api service {% raw %}{{ $labels.url }}{% endraw %} of job {% raw %}{{ $labels.job }}{% endraw %} has been DOWN for more than 30s."
{% endfor %}
